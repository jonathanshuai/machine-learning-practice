import numpy as np
import pandas as pd
import sqlite3 as sql
import scipy.optimize
import scipy.stats
import matplotlib as mpl
import seaborn as sns
from matplotlib import pyplot as plt

import time 
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import accuracy_score

#Our logistic regression implementation
from b_LogisticRegression import b_LogisticRegression
from n_LogisticRegression import n_LogisticRegression
from m_LogisticRegression import m_LogisticRegression

#Dataset from https://www.kaggle.com/aniruddhaachar/audio-features/data

#Read in the data
t = time.time()
print("Loading...")
dinner_df = pd.read_csv("dinner_audio.csv")
party_df = pd.read_csv("party_audio.csv")
sleep_df = pd.read_csv("sleep_audio.csv")
workout_df = pd.read_csv("workout_audio.csv")
#database = sql.connect("database.sqlite")
print("Done! {}s".format(time.time() - t))

#Add labels to the data
dinner_df['label'] = pd.Series(["dinner"]*len(dinner_df))
party_df['label'] = pd.Series(["party"]*len(dinner_df))
sleep_df['label'] = pd.Series(["sleep"]*len(dinner_df))
workout_df['label'] = pd.Series(["workout"]*len(dinner_df))

#Make one big dataframe
df = pd.concat([dinner_df, party_df, workout_df, sleep_df])
df = df.dropna()

#get the features we want and set the label column name
features = ['mfcc', 'scem', 'scom', 'srom', 'sbwm', 'tempo', 'rmse']
label = 'label'

#Create a minimalist scatterplot matrix just for fun
def scatterplot_matrix(df, features, kwargs, label='label'):
  fig, axs = plt.subplots(len(features),len(features))
  for (i, f1) in enumerate(features):
    for (j, f2) in enumerate(features):
      ax = axs[i,j]
      ax.set_xticklabels([])
      ax.set_yticklabels([])
      ax.set_xticks([])
      ax.set_yticks([])
      if j == 0:
        ax.set_ylabel(f1)
      if i == 0:
        ax.set_xlabel(f2)
        ax.xaxis.set_label_position('top')
      if i == j:
        continue
      else:
        le = LabelEncoder()
        labels = le.fit_transform(df[label])
        #labels = le.transform(df[label])
        ax.scatter(df[f2], df[f1], c=labels, **kwargs)
  plt.tight_layout(pad=0)
  plt.show()


#use our simple scatterplot matrix function
kwargs = {'s':2, 'cmap':'winter'}
#scatterplot_matrix(df=df, features=features, kwargs=kwargs, label=label)


#Create the df that we want to try predicting on
df = pd.concat([dinner_df, workout_df, sleep_df])
#df = pd.concat([dinner_df, workout_df])
df = df.dropna()

labels = df[label]
dff = df[features]

#normalize the huge features
dff = (dff - dff.mean()) / (dff.max() - dff.min())

#Train and test sets
X_train, X_test, y_train, y_test = train_test_split(dff, labels, test_size=0.3)

X = X_train.as_matrix()
y = y_train.as_matrix()
X_test = X_test.as_matrix()

b = np.ones(X.shape[0])
X = np.c_[b, X]
b = np.ones(X_test.shape[0])
X_test = np.c_[b, X_test] 

'''
X = np.array([ 
       [  1.00000000e+00,  -1.56093835e-01,  -3.15023284e-01,
          4.16882769e-01,  -3.18917351e-01,  -3.54055828e-01,
         -2.52512352e-01,  -2.87440359e-01],
       [  1.00000000e+00,   2.77121820e-01,   3.24134518e-01,
         -2.90884077e-01,   2.63988501e-01,   2.16227129e-01,
          1.56844373e-01,   2.20909398e-01],
       [  1.00000000e+00,   2.16763167e-01,   3.98733052e-01,
         -1.68475401e-01,   4.00852742e-01,   3.41013998e-01,
         -8.34302261e-02,   4.92236625e-01],
       [  1.00000000e+00,   2.48064540e-01,   4.71517035e-01,
         -4.75463862e-01,   4.60425300e-01,   3.63775847e-01,
          3.19383073e-01,   3.84726111e-01],
       [  1.00000000e+00,   2.61671033e-01,   1.62131906e-01,
         -1.72799044e-01,   1.47397643e-01,   1.77348142e-01,
         -1.74734574e-01,   3.15078539e-01],
       [  1.00000000e+00,   4.19831151e-02,   1.36812438e-02,
         -7.78596642e-02,   5.91032768e-02,   1.75673838e-01,
          3.19383073e-01,  -1.69720645e-01],
       [  1.00000000e+00,  -2.08513102e-01,  -3.95019298e-01,
          3.73315453e-01,  -3.95911314e-01,  -4.76506178e-01,
          8.77654261e-02,  -2.51955597e-01],
       [  1.00000000e+00,  -1.03149822e-02,  -8.09799087e-02,
         -9.07012859e-02,  -3.99527585e-02,   1.29361747e-01,
         -1.30984574e-01,  -2.05297601e-01],
       [  1.00000000e+00,   2.66593781e-02,  -4.27346006e-03,
          1.27494575e-02,   2.25781064e-02,   1.43327748e-01,
         -2.87234574e-01,  -1.04714752e-01],
       [  1.00000000e+00,   2.24918413e-01,   1.54256256e-01,
         -2.18638930e-01,   1.60316608e-01,   1.91117862e-01,
         -8.34302261e-02,   2.64124252e-01],
       [  1.00000000e+00,   2.71217174e-01,   3.75101355e-01,
         -3.76992254e-01,   3.40522886e-01,   2.97948078e-01,
         -2.52512352e-01,   3.17582475e-01],
       [  1.00000000e+00,   1.33965732e-01,   1.87888342e-01,
         -4.56666967e-02,   2.22638359e-01,   2.62827008e-01,
         -3.19562160e-01,   3.10490922e-02],
       [  1.00000000e+00,  -1.29426695e-01,   5.24705647e-01,
          5.42327403e-02,   5.52256875e-01,   4.48205760e-01,
         -1.30984574e-01,  -2.20735312e-01],
       [  1.00000000e+00,   2.97175680e-01,   3.17045555e-01,
         -2.10456437e-01,   3.20119745e-01,   2.71586403e-01,
          8.77654261e-02,   3.59511159e-01],
       [  1.00000000e+00,   2.08725398e-02,  -3.12127752e-02,
          2.02279036e-02,   2.26525366e-02,   1.83318386e-01,
          8.77654261e-02,  -1.01952648e-01],
       [  1.00000000e+00,   4.72174465e-02,   2.23167637e-01,
         -8.52537010e-02,   4.31649146e-01,   4.50063689e-01,
          2.33598759e-01,  -1.64658129e-01],
       [  1.00000000e+00,  -4.03765302e-02,   1.43804142e-02,
         -9.43797628e-02,   2.91397831e-02,   9.05527246e-02,
         -4.74734574e-01,  -3.47051239e-02],
       [  1.00000000e+00,   1.57090811e-02,   1.07047313e-01,
          2.31950901e-03,   1.08385557e-01,   1.48852464e-01,
          4.15890426e-01,  -1.05643165e-01],
       [  1.00000000e+00,  -6.94459551e-02,   1.06536440e-01,
          1.36700311e-01,   8.32411264e-02,   1.10722890e-01,
          3.19383073e-01,  -2.26896317e-01],
       [  1.00000000e+00,  -2.01076819e-01,  -3.00044693e-01,
          4.17181953e-01,  -3.12655758e-01,  -3.44863210e-01,
          2.33598759e-01,  -7.29000335e-02],
       [  1.00000000e+00,  -8.68575567e-02,  -3.55363264e-01,
          3.19059057e-01,  -3.54465477e-01,  -4.09985983e-01,
         -3.49734574e-01,  -6.80560868e-02],
       [  1.00000000e+00,  -3.54347948e-01,  -3.81646795e-01,
          2.36375120e-01,  -4.02731724e-01,  -3.77393581e-01,
          3.19383073e-01,  -3.54711392e-01],
       [  1.00000000e+00,  -1.55382487e-01,  -2.52942727e-01,
          5.24536138e-01,  -2.57883361e-01,  -2.92416330e-01,
         -1.30984574e-01,  -3.45283028e-02],
       [  1.00000000e+00,  -6.78107277e-02,  -2.74269871e-01,
          1.32006167e-01,  -2.90475542e-01,  -1.98276856e-01,
         -3.19562160e-01,  -2.21783710e-01],
       [  1.00000000e+00,  -1.09209523e-01,   3.73157265e-01,
          5.10265415e-02,   3.20118364e-01,   2.71670981e-01,
          5.25265426e-01,  -2.44821870e-01],
       [  1.00000000e+00,  -3.16930110e-01,  -3.65181138e-01,
          2.23936172e-01,  -3.89764320e-01,  -4.17775185e-01,
          2.33598759e-01,  -2.94471295e-01],
       [  1.00000000e+00,   1.76795431e-01,   4.47288711e-01,
         -1.93995200e-01,   3.96026590e-01,   3.14282058e-01,
         -2.87234574e-01,   2.21641740e-01],
       [  1.00000000e+00,  -6.55905893e-01,  -3.54288263e-01,
          2.37820007e-01,  -3.81447034e-01,  -3.24565482e-01,
         -3.49734574e-01,  -4.13119328e-01],
       [  1.00000000e+00,  -5.02838963e-03,   1.47076950e-03,
         -6.10506364e-03,   4.88661633e-02,   1.94376673e-01,
         -1.74734574e-01,  -1.69409139e-01],
       [  1.00000000e+00,  -2.32756635e-01,  -4.13255532e-01,
          1.48141428e-01,  -4.32772011e-01,  -4.59360865e-01,
          2.52654261e-02,  -1.45308749e-01],
       [  1.00000000e+00,  -1.23113944e-01,  -3.31039284e-01,
          4.91109261e-01,  -3.38620103e-01,  -4.19817900e-01,
          2.33598759e-01,  -6.73713452e-02],
       [  1.00000000e+00,  -1.83981380e-01,  -3.85918139e-01,
          2.92002776e-01,  -4.00189281e-01,  -4.52319493e-01,
         -3.15527558e-02,  -1.28213460e-01],
       [  1.00000000e+00,  -2.24171176e-01,  -4.03958050e-01,
          2.29669381e-01,  -4.04469612e-01,  -4.87621135e-01,
         -2.15119189e-01,  -1.47738039e-01],
       [  1.00000000e+00,  -1.62193166e-01,  -3.91445081e-01,
          3.99614156e-01,  -3.86875717e-01,  -4.90683654e-01,
          8.77654261e-02,  -8.31693972e-02],
       [  1.00000000e+00,  -1.52321054e-01,  -4.17860728e-01,
          3.08824710e-01,  -4.25808647e-01,  -5.23563275e-01,
          3.19383073e-01,  -2.05108114e-01],
       [  1.00000000e+00,  -3.83950210e-01,  -3.93687834e-01,
          3.58719342e-01,  -3.96950975e-01,  -4.56588941e-01,
          2.52654261e-02,  -3.71109610e-01],
       [  1.00000000e+00,  -1.85337606e-02,   1.12583682e-01,
         -2.49420303e-02,   1.44910727e-01,   1.64143035e-01,
         -3.15527558e-02,  -2.17378798e-01],
       [  1.00000000e+00,  -1.10185490e-01,  -2.42985754e-01,
          2.34384169e-01,  -2.72062915e-01,  -1.74732508e-01,
         -3.15527558e-02,  -2.66246714e-01],
       [  1.00000000e+00,  -2.37035872e-01,  -3.76280159e-01,
          3.26344032e-01,  -3.85569053e-01,  -4.79413278e-01,
          8.77654261e-02,  -2.53863282e-01],
       [  1.00000000e+00,  -3.32965146e-01,  -3.83994959e-01,
          4.90079856e-01,  -3.92004316e-01,  -4.86894726e-01,
          1.56844373e-01,  -2.08159592e-01],
       [  1.00000000e+00,  -5.80070197e-04,  -1.47752988e-01,
         -1.26962926e-01,  -1.36084748e-01,   5.45783599e-02,
         -1.74734574e-01,  -2.32627159e-01],
       [  1.00000000e+00,   4.53842142e-02,   3.13223523e-01,
         -2.63254528e-01,   2.76556581e-01,   2.41125411e-01,
         -8.34302261e-02,   1.92142111e-01],
       [  1.00000000e+00,   1.49138033e-01,   3.44475281e-01,
         -6.31636432e-02,   3.99224728e-01,   3.75067947e-01,
          8.77654261e-02,   3.67548173e-01],
       [  1.00000000e+00,   4.88977898e-03,   2.95900098e-01,
         -1.04132089e-01,   3.68247565e-01,   3.43217260e-01,
         -3.77960380e-01,  -1.58826173e-02],
       [  1.00000000e+00,  -5.06488531e-01,  -3.64880106e-01,
          4.15737425e-01,  -3.94676717e-01,  -4.45450621e-01,
          8.77654261e-02,  -3.75656591e-01],
       [  1.00000000e+00,   1.56844787e-02,  -1.91150239e-01,
         -3.42774497e-02,  -1.81678595e-01,  -2.67977057e-02,
         -3.19562160e-01,  -1.62293336e-01],
       [  1.00000000e+00,   3.25945574e-01,   5.55729359e-01,
         -3.56220291e-01,   5.05220499e-01,   3.57647451e-01,
          3.19383073e-01,   3.97629341e-01],
       [  1.00000000e+00,   2.10148764e-01,   1.36066965e-01,
         -3.24238932e-01,   1.44582289e-01,   1.98080542e-01,
         -3.49734574e-01,  -2.52634630e-02],
       [  1.00000000e+00,  -1.90864601e-01,  -4.20841356e-01,
          3.17397034e-01,  -4.32518003e-01,  -5.49936311e-01,
          2.52654261e-02,  -1.33868946e-01],
       [  1.00000000e+00,  -6.40899039e-02,   1.05482003e-01,
          6.54696509e-02,   1.27853203e-01,   1.71629450e-01,
         -3.15527558e-02,  -2.28347855e-01],
       [  1.00000000e+00,   5.63552122e-02,   6.48521326e-02,
         -1.97601968e-01,   1.24149412e-01,   2.22878260e-01,
          3.19383073e-01,  -1.03728701e-01],
       [  1.00000000e+00,  -2.36520346e-01,  -3.70234742e-01,
          2.78884190e-01,  -3.93000264e-01,  -4.71590112e-01,
          8.77654261e-02,  -2.41845861e-01],
       [  1.00000000e+00,   2.88886110e-01,   1.91294972e-01,
         -2.56603306e-01,   2.28963750e-01,   2.76375274e-01,
         -3.15527558e-02,   3.84248827e-01],
       [  1.00000000e+00,   1.98720549e-02,   8.96856550e-03,
          4.42181832e-02,   1.80827553e-02,   1.21572957e-01,
         -3.19562160e-01,  -8.17877509e-02],
       [  1.00000000e+00,  -1.37555500e-01,  -3.84971737e-01,
          3.76413173e-01,  -3.86170402e-01,  -4.20167485e-01,
          3.19383073e-01,  -2.82449278e-01],
       [  1.00000000e+00,   1.46589138e-01,   2.21219412e-01,
         -1.33718966e-01,   1.48112409e-01,   9.75798156e-02,
          1.56844373e-01,   8.84812858e-02],
       [  1.00000000e+00,   3.38969975e-01,   1.78130414e-01,
         -2.38281585e-01,   1.66154067e-01,   2.04204430e-01,
         -3.49734574e-01,   4.54907119e-01],
       [  1.00000000e+00,   1.43733543e-01,   2.18077060e-01,
         -1.55144738e-01,   2.19526466e-01,   2.15798374e-01,
          5.25265426e-01,   3.57311023e-01],
       [  1.00000000e+00,   3.15168855e-01,   4.10604167e-01,
         -4.26629382e-01,   3.64696179e-01,   3.03218235e-01,
         -3.15527558e-02,   2.76177259e-01],
       [  1.00000000e+00,   3.14742867e-01,   3.22341002e-01,
         -2.36469958e-01,   3.82086867e-01,   3.67236131e-01,
          1.56844373e-01,   5.32283332e-01],
       [  1.00000000e+00,  -1.77079553e-01,  -4.04122246e-01,
          1.71337396e-01,  -4.11789768e-01,  -4.52773984e-01,
          2.33598759e-01,  -7.92368313e-02],
       [  1.00000000e+00,  -3.69733543e-01,  -3.93818978e-01,
          5.17938423e-01,  -3.93321614e-01,  -4.70726089e-01,
         -2.15119189e-01,  -2.85061425e-01],
       [  1.00000000e+00,  -3.65347513e-01,  -4.13968672e-01,
          3.66971414e-01,  -4.20815913e-01,  -5.07823685e-01,
         -2.15119189e-01,  -3.05848934e-01],
       [  1.00000000e+00,  -1.00398494e-01,  -3.89876103e-01,
          1.74368158e-01,  -3.90638580e-01,  -4.98141333e-01,
         -3.49734574e-01,  -2.15040068e-01],
       [  1.00000000e+00,   2.04183123e-01,   2.67707152e-01,
         -3.01984461e-01,   3.00909451e-01,   2.98914089e-01,
         -1.74734574e-01,   3.30398826e-01],
       [  1.00000000e+00,  -2.87503764e-02,  -4.01596847e-01,
          1.40671796e-01,  -4.27261809e-01,  -3.68001773e-01,
          8.77654261e-02,  -1.39543667e-02],
       [  1.00000000e+00,   3.09036460e-01,   3.23966956e-01,
         -3.73541304e-01,   3.19776930e-01,   2.64948902e-01,
          8.77654261e-02,   4.52719238e-01],
       [  1.00000000e+00,   1.00702501e-01,  -1.60048131e-02,
         -2.55984002e-02,   3.82557171e-02,   1.59228741e-01,
          2.52654261e-02,  -1.88514466e-02],
       [  1.00000000e+00,   2.75970456e-01,   2.65244199e-01,
         -2.20158186e-01,   2.90758582e-01,   2.97426602e-01,
          1.56844373e-01,   3.20927810e-01],
       [  1.00000000e+00,  -1.87902537e-01,  -4.20569563e-01,
          2.55239304e-01,  -4.27168476e-01,  -4.88157738e-01,
          3.19383073e-01,  -3.17789970e-01],
       [  1.00000000e+00,  -1.61909662e-01,   3.85997474e-01,
         -1.43145548e-01,   4.79755900e-01,   4.33504753e-01,
          3.19383073e-01,  -3.48826169e-01],
       [  1.00000000e+00,  -1.90959649e-02,   8.66618349e-02,
         -3.57611978e-02,   1.20192794e-01,   1.79718963e-01,
          1.56844373e-01,  -1.29275759e-01],
       [  1.00000000e+00,   1.01305782e-01,  -1.44456940e-02,
          1.91566165e-01,  -7.92884634e-03,   5.49801481e-02,
         -3.15527558e-02,   8.02288577e-02],
       [  1.00000000e+00,   2.64578039e-01,   2.93227897e-01,
         -1.82787815e-01,   3.17190774e-01,   3.02452140e-01,
          1.56844373e-01,   4.89310183e-01],
       [  1.00000000e+00,  -3.67814911e-02,   3.16662284e-01,
         -4.29643299e-02,   3.12279558e-01,   2.91901461e-01,
          2.33598759e-01,  -1.29956156e-01],
       [  1.00000000e+00,   2.59226871e-01,   2.79059738e-01,
         -1.23751875e-01,   2.11164286e-01,   1.78602839e-01,
          2.33598759e-01,   3.85596819e-01],
       [  1.00000000e+00,  -3.54095943e-01,  -3.90443902e-01,
          3.32567590e-01,  -3.93413765e-01,  -4.82402809e-01,
          2.52654261e-02,  -2.63787063e-01],
       [  1.00000000e+00,   3.44094107e-01,   4.58801444e-01,
         -2.29565039e-01,   4.70089419e-01,   3.86331121e-01,
         -1.30984574e-01,   4.70587176e-01],
       [  1.00000000e+00,   2.20307080e-01,  -1.50019856e-03,
         -1.03659187e-01,   3.19716770e-02,   1.32145344e-01,
          4.15890426e-01,   1.57847097e-01],
       [  1.00000000e+00,   2.51367274e-01,   3.78172447e-01,
         -3.29636428e-01,   2.85314541e-01,   2.10793666e-01,
         -3.15527558e-02,   3.04408961e-01],
       [  1.00000000e+00,  -1.74337649e-01,  -3.91401500e-01,
          2.05513326e-01,  -3.95067771e-01,  -4.79543522e-01,
          2.52654261e-02,  -5.65054218e-02],
       [  1.00000000e+00,   1.36763987e-01,   2.76784971e-01,
         -3.08343135e-01,   2.17942165e-01,   1.64046796e-01,
          2.52654261e-02,  -3.95300487e-02],
       [  1.00000000e+00,  -4.76624049e-01,  -3.39042320e-01,
          2.01524571e-01,  -3.65884023e-01,  -4.42941635e-01,
         -1.30984574e-01,  -3.29668774e-01],
       [  1.00000000e+00,  -1.82438865e-02,   2.41473335e-01,
         -5.12399868e-02,   2.26240547e-01,   2.17811714e-01,
         -3.15527558e-02,   1.00593919e-01],
       [  1.00000000e+00,   6.25108108e-02,   2.58757198e-02,
         -6.67283110e-02,   9.56839746e-02,   1.71606755e-01,
          2.52654261e-02,  -5.29391870e-02],
       [  1.00000000e+00,   2.97898988e-01,   3.48083811e-01,
         -3.04403263e-01,   2.79991005e-01,   2.42500738e-01,
         -2.87234574e-01,   3.06970832e-01],
       [  1.00000000e+00,   1.69903179e-01,   3.46174475e-01,
         -2.02098249e-01,   3.69703090e-01,   3.51902593e-01,
          3.19383073e-01,   1.59250051e-01],
       [  1.00000000e+00,  -5.21397563e-01,  -3.43206461e-01,
          4.25024827e-01,  -3.58678465e-01,  -3.96357397e-01,
          1.56844373e-01,  -3.87729272e-01],
       [  1.00000000e+00,   2.12580394e-01,   4.18793609e-01,
         -2.97062292e-01,   3.48502282e-01,   2.74936190e-01,
          2.52654261e-02,  -3.51932909e-02],
       [  1.00000000e+00,   1.01325180e-01,   7.18161051e-02,
         -2.65624636e-02,   8.48844991e-02,   1.73730751e-01,
          8.77654261e-02,  -2.43986081e-02],
       [  1.00000000e+00,   3.14269006e-02,  -6.48002537e-02,
         -1.68270948e-01,  -4.94207594e-02,   7.21026567e-02,
          8.77654261e-02,  -1.09898943e-01],
       [  1.00000000e+00,  -2.13037538e-02,  -8.20103055e-02,
         -8.33203710e-02,  -9.40044817e-02,   4.30564007e-02,
         -3.19562160e-01,  -1.67843333e-01]])
y = np.array(['sleep', 'workout', 'workout', 'workout', 'workout', 'dinner',
       'sleep', 'dinner', 'dinner', 'workout', 'workout', 'dinner',
       'dinner', 'workout', 'dinner', 'dinner', 'dinner', 'dinner',
       'dinner', 'sleep', 'sleep', 'sleep', 'sleep', 'dinner', 'dinner',
       'sleep', 'workout', 'sleep', 'dinner', 'sleep', 'sleep', 'sleep',
       'sleep', 'sleep', 'sleep', 'sleep', 'dinner', 'sleep', 'sleep',
       'sleep', 'dinner', 'workout', 'workout', 'dinner', 'sleep',
       'dinner', 'workout', 'workout', 'sleep', 'dinner', 'dinner',
       'sleep', 'workout', 'dinner', 'sleep', 'workout', 'workout',
       'workout', 'workout', 'workout', 'sleep', 'sleep', 'sleep', 'sleep',
       'dinner', 'sleep', 'workout', 'dinner', 'workout', 'sleep',
       'dinner', 'dinner', 'dinner', 'workout', 'dinner', 'workout',
       'sleep', 'workout', 'dinner', 'workout', 'sleep', 'workout',
       'sleep', 'workout', 'dinner', 'workout', 'workout', 'sleep',
       'workout', 'dinner', 'dinner', 'dinner'])
X = np.array([
       [ 1.        ,  0.41833427, -0.00984982, -0.11315728, -0.03075136,
        -0.01657122, -0.334358  ,  0.37063965],
       [ 1.        ,  0.29758113,  0.1660589 , -0.17878491,  0.08534057,
         0.00197258,  0.17222095,  0.12056376],
       [ 1.        ,  0.10170261,  0.31443758, -0.05790496,  0.24201912,
         0.15321243, -0.271858  ,  0.12134642],
       [ 1.        , -0.36860501, -0.09737811,  0.26580711, -0.07619979,
        -0.06681485, -0.01617618, -0.35956232],
       [ 1.        ,  0.3513744 ,  0.19859419, -0.01311212,  0.20601253,
         0.20558377, -0.06805365,  0.36338429],
       [ 1.        ,  0.28605283,  0.22746478, -0.2862147 ,  0.17615752,
         0.12801891, -0.23713578,  0.22387932],
       [ 1.        ,  0.3830646 ,  0.22270041, -0.23641552,  0.13975139,
         0.03206347,  0.040642  ,  0.21431854],
       [ 1.        , -0.57166131, -0.41216541,  0.1026333 , -0.39437103,
        -0.36018246,  0.040642  , -0.46234769],
       [ 1.        , -0.2446076 , -0.40248079,  0.02572547, -0.38939286,
        -0.24735437, -0.159358  , -0.36413565],
       [ 1.        ,  0.04630025, -0.22021968, -0.11033605, -0.15578466,
        -0.02969598, -0.23713578, -0.05820717],
       [ 1.        ,  0.38206819,  0.20874348, -0.25916331,  0.255755  ,
         0.24028058,  0.103142  ,  0.50925826],
       [ 1.        ,  0.03715215,  0.03827871, -0.00943456,  0.0325812 ,
         0.00131127,  0.540642  ,  0.26633765],
       [ 1.        ,  0.12321872,  0.34522906, -0.28412052,  0.29660658,
         0.1865408 ,  0.103142  ,  0.25063789],
       [ 1.        , -0.18211678, -0.30253765, -0.02581101, -0.28655596,
        -0.22032491,  0.103142  , -0.23297468],
       [ 1.        ,  0.24084933,  0.34362836, -0.40906929,  0.31843567,
         0.22955162,  0.33475965,  0.29563645],
       [ 1.        ,  0.17973613,  0.25593673, -0.02606609,  0.24774591,
         0.19444376, -0.06805365,  0.4105341 ],
       [ 1.        ,  0.26264281,  0.11175188,  0.02973162,  0.0226585 ,
        -0.0560591 ,  0.24897533,  0.29656698],
       [ 1.        ,  0.2953332 ,  0.09510664, -0.09054627,  0.11710638,
         0.12721459,  0.17222095,  0.22745452],
       [ 1.        , -0.25329255, -0.22269297,  0.17650947, -0.1699271 ,
        -0.03172955, -0.159358  , -0.29657387],
       [ 1.        , -0.26361416, -0.32203123,  0.07096601, -0.27532107,
        -0.13200853, -0.115608  , -0.33492826],
       [ 1.        ,  0.37186465,  0.27023929, -0.34814269,  0.20484194,
         0.1361476 , -0.01617618,  0.17962912],
       [ 1.        , -0.14723797,  0.33699405, -0.13101777,  0.27549385,
         0.15482057, -0.115608  , -0.14952425],
       [ 1.        ,  0.37103295,  0.16389803, -0.11089707,  0.22547801,
         0.23488876,  0.17222095,  0.45333244],
       [ 1.        ,  0.33814674,  0.19491349, -0.19565164,  0.1043294 ,
         0.04249697, -0.271858  ,  0.21253854],
       [ 1.        , -0.27909466,  0.06646702,  0.12019849,  0.04054823,
         0.00441664, -0.01617618, -0.00801869],
       [ 1.        , -0.08883112,  0.10011152,  0.08093066,  0.14241782,
         0.14246361, -0.30418559, -0.18106673],
       [ 1.        , -0.45669713,  0.2251225 ,  0.24778768,  0.15194518,
         0.08748914,  0.540642  , -0.37716827],
       [ 1.        ,  0.04272745,  0.04206468,  0.01729654, -0.05215989,
        -0.18102895,  0.17222095, -0.02096359],
       [ 1.        , -0.4961694 ,  0.40771108,  0.25178778,  0.42740451,
         0.35977626, -0.115608  , -0.35142671],
       [ 1.        ,  0.33673455,  0.15751797, -0.07844223,  0.15194682,
         0.08735868,  0.103142  ,  0.26868896],
       [ 1.        , -0.32230672, -0.20713916,  0.06637669, -0.19333474,
        -0.19186753, -0.459358  , -0.15261424],
       [ 1.        , -0.00724052, -0.23634433, -0.10846387, -0.16157313,
        -0.04929869, -0.06805365,  0.11128754],
       [ 1.        ,  0.39290526,  0.44508909, -0.2602993 ,  0.37159038,
         0.22009918,  0.33475965,  0.30942627],
       [ 1.        ,  0.17156963,  0.2801061 , -0.18649294,  0.185626  ,
         0.09252539,  0.040642  , -0.15313595],
       [ 1.        , -0.04564648, -0.13793947,  0.15098652, -0.12718715,
        -0.0635738 ,  0.103142  , -0.14159955],
       [ 1.        ,  0.24729763,  0.2311649 , -0.2271329 ,  0.1106464 ,
        -0.00640799, -0.01617618,  0.20980064],
       [ 1.        ,  0.42833869,  0.32830836, -0.1022824 ,  0.32990327,
         0.26434086, -0.115608  ,  0.3873971 ],
       [ 1.        , -0.44573484,  0.10687816,  0.24327662,  0.03335084,
        -0.04515184,  0.103142  , -0.45567082],
       [ 1.        ,  0.22469423, -0.02405457, -0.23063818, -0.02634236,
        -0.04305639,  0.17222095,  0.37877003],
       [ 1.        , -0.21285248, -0.45476669,  0.1413612 , -0.44349526,
        -0.37286876, -0.30418559, -0.28896914],
       [ 1.        , -0.16412025, -0.03037965,  0.19927129, -0.03437109,
        -0.00685204,  0.24897533, -0.2167722 ],
       [ 1.        , -0.12142815, -0.19328939,  0.10087504, -0.11437232,
        -0.06684986,  0.040642  , -0.17210118],
       [ 1.        , -0.21280445, -0.09549219,  0.18702009, -0.09930042,
        -0.10194606,  0.431267  , -0.22842649],
       [ 1.        , -0.16150669, -0.20798154,  0.0869874 , -0.15777957,
        -0.06057679,  0.33475965, -0.29690678],
       [ 1.        ,  0.25904599,  0.08076774, -0.05711376,  0.07236031,
         0.06211042, -0.30418559,  0.2012783 ],
       [ 1.        , -0.47891947, -0.26812226,  0.59093071, -0.29714316,
        -0.35032717, -0.01617618, -0.31913294],
       [ 1.        , -0.04686221, -0.24374791,  0.1521893 , -0.18251762,
        -0.0859417 ,  0.040642  , -0.13567124],
       [ 1.        , -0.04568435, -0.24186945,  0.42312693, -0.23732098,
        -0.24673465, -0.01617618, -0.02978305],
       [ 1.        ,  0.30993427,  0.0570965 , -0.15939104,  0.03998327,
         0.01609717,  0.33475965,  0.38865622],
       [ 1.        , -0.31528772,  0.1570562 ,  0.13052332,  0.14264352,
         0.11869261,  0.24897533, -0.25441004],
       [ 1.        ,  0.26741482, -0.02912515, -0.03146033, -0.05300804,
        -0.05799434, -0.159358  ,  0.22120334],
       [ 1.        ,  0.18665531, -0.22627245,  0.05479955, -0.18997437,
        -0.12771511,  0.431267  ,  0.0531684 ],
       [ 1.        , -0.15128711,  0.04441194,  0.0777625 ,  0.28428942,
         0.36264192,  0.24897533, -0.29149642],
       [ 1.        , -0.15021491, -0.36329787,  0.06526996, -0.34922401,
        -0.30757689, -0.36258381, -0.1167562 ],
       [ 1.        , -0.20272325, -0.26207077,  0.20936286, -0.20103261,
        -0.04878584,  0.103142  , -0.22448239],
       [ 1.        ,  0.19565853, -0.0386139 , -0.08865083, -0.03767819,
        -0.03675594, -0.06805365,  0.16674794],
       [ 1.        , -0.28075827, -0.12005303,  0.13951005, -0.08528976,
        -0.05433759,  0.17222095, -0.2536829 ],
       [ 1.        , -0.15941582,  0.23579375,  0.10732338,  0.19486176,
         0.13390721, -0.159358  ,  0.15195135],
       [ 1.        ,  0.04770395,  0.19056586,  0.10532237,  0.24581408,
         0.24696854,  0.103142  ,  0.2772782 ],
       [ 1.        ,  0.15247329,  0.22555374, -0.29561121,  0.13438629,
         0.05925709, -0.30418559, -0.14376424],
       [ 1.        ,  0.32054989,  0.0060111 , -0.13601573,  0.04377963,
         0.09474504, -0.01617618,  0.29512637]])
y = np.array(['workout', 'workout', 'workout', 'dinner', 'workout', 'workout',
       'workout', 'dinner', 'dinner', 'workout', 'workout', 'workout',
       'workout', 'dinner', 'workout', 'workout', 'workout', 'workout',
       'dinner', 'dinner', 'workout', 'dinner', 'workout', 'workout',
       'workout', 'dinner', 'dinner', 'workout', 'dinner', 'workout',
       'dinner', 'dinner', 'workout', 'workout', 'dinner', 'workout',
       'workout', 'dinner', 'workout', 'dinner', 'dinner', 'dinner',
       'dinner', 'dinner', 'workout', 'dinner', 'dinner', 'dinner',
       'workout', 'dinner', 'workout', 'dinner', 'dinner', 'dinner',
       'dinner', 'workout', 'dinner', 'workout', 'workout', 'workout',
       'workout'])
'''


#multinomial regression
clfk = LogisticRegression()
clfk.fit(X, y)
predictions = clfk.predict(X_test)
acc = accuracy_score(y_test, predictions)
print(acc)




#clf = m_LogisticRegression(solver='lbfgs')
clf = m_LogisticRegression(solver='newton-raphson')
clf.fit(X, y)
predictions = clf.predict(X_test)
acc = accuracy_score(y_test, predictions)
print(acc)


